<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…ë„: ì—­ì‚¬ì™€ ì§„ì‹¤ì˜ ê¸°ë¡ (Dokdo History Explorer)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;500;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fdfbf7; /* Warm neutral background */
            color: #2c2c2c;
        }
        h1, h2, h3, .serif {
            font-family: 'Noto Serif KR', serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* Custom scrollbar */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        /* Timeline Specific Styles */
        .timeline-line {
            position: absolute;
            left: 23px; /* Center of the dot */
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #e2e8f0;
            z-index: 0;
        }
        .timeline-item {
            position: relative;
            z-index: 1;
        }
        .timeline-dot {
            position: absolute;
            left: 16px;
            top: 20px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #e2e8f0;
            border: 3px solid #fff;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .timeline-item.active .timeline-dot {
            background-color: #1e3a8a;
            transform: scale(1.2);
            border-color: #bfdbfe;
        }
        .timeline-item:hover .timeline-dot {
            background-color: #3b82f6;
        }
        /* Image Overlay for Header */
        .header-bg {
            background-image: linear-gradient(rgba(15, 23, 42, 0.7), rgba(15, 23, 42, 0.7)), url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Dokdo_080628.jpg/1200px-Dokdo_080628.jpg');
            background-size: cover;
            background-position: center;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (#fdfbf7) with Deep Sea Blue (#1e3a8a) accents. -->
    <!-- Application Structure Plan: 
         1. Header: Context (Now with BG Image).
         2. Dashboard: High-level charts.
         3. Vertical Timeline Split View: Left timeline, Right Detail View (Now with Image support).
         4. Search.
    -->
    <!-- Visualization & Content Choices:
         - Added real historical image URLs to the data structure.
         - Updated detail view to render images if available.
    -->
    <!-- CONFIRMATION: NO SVG graphics used (except generic icons as text/emoji). NO Mermaid JS used. -->
</head>
<body class="flex flex-col min-h-screen">

    <!-- Header Section -->
    <header class="bg-slate-900 text-white py-8 shadow-lg">
        <div class="container mx-auto px-4 relative">
            <!-- Home Button -->
            <a href="index.html" class="absolute top-0 left-4 md:left-0 inline-flex items-center text-slate-400 hover:text-blue-300 transition-colors group">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1 group-hover:-translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                <span class="font-medium">Home</span>
            </a>

            <div class="text-center mt-8 md:mt-0">
                <p class="text-sm tracking-widest uppercase text-slate-400 mb-2">ëŒ€í•œë¯¼êµ­ ì˜í† ì˜ ì‹œì‘</p>
                <h1 class="text-3xl md:text-5xl font-bold mb-4">ë…ë„, ì—­ì‚¬ì™€ ê¸°ë¡</h1>
                <p class="max-w-2xl mx-auto text-slate-300 font-light leading-relaxed">
                    ìˆ˜ë°±ë§Œ ë…„ ì „ì˜ íƒ„ìƒë¶€í„° í˜„ì¬ì— ì´ë¥´ê¸°ê¹Œì§€, ë…ë„ê°€ ëŒ€í•œë¯¼êµ­ì˜ ì˜í† ì„ì„ ì¦ëª…í•˜ëŠ” ì—­ì‚¬ì  ì‚¬ì‹¤ê³¼ ì£¼ìš” ì‚¬ê±´ë“¤ì„ ì—°ë„ë³„ë¡œ íƒí—˜í•´ë³´ì„¸ìš”.
                </p>
            </div>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 space-y-12">

        <!-- Dashboard Section -->
        <section id="dashboard" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
            <div class="md:col-span-2">
                <div class="border-l-4 border-blue-900 pl-4 mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">ì—­ì‚¬ì˜ íë¦„ ë¶„ì„</h2>
                    <p class="text-slate-600 mt-1">
                        ë…ë„ ê´€ë ¨ ê¸°ë¡ì€ ë‹¨ìˆœí•œ ì£¼ì¥ì´ ì•„ë‹Œ, ë¬¸í—Œê³¼ ì§€ë„, êµ­ì œë²•ì  ë¬¸ì„œë¡œ ë’·ë°›ì¹¨ë©ë‹ˆë‹¤. ì•„ë˜ ì°¨íŠ¸ëŠ” ì—­ì‚¬ì  ì‚¬ê±´ë“¤ì˜ ìœ í˜•ê³¼ ì‹œëŒ€ë³„ ë¶„í¬ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                </div>
            </div>

            <!-- Chart 1: Event Categories -->
            <div class="bg-white p-6 rounded-xl card-shadow border border-slate-100">
                <h3 class="text-lg font-semibold text-slate-700 mb-4 text-center">ê¸°ë¡ ë° ì‚¬ê±´ ìœ í˜•ë³„ ë¶„í¬</h3>
                <div class="chart-container">
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>

            <!-- Chart 2: Timeline Density -->
            <div class="bg-white p-6 rounded-xl card-shadow border border-slate-100">
                <h3 class="text-lg font-semibold text-slate-700 mb-4 text-center">ì‹œëŒ€ë³„ ì£¼ìš” ì‚¬ê±´ ë¹ˆë„</h3>
                <div class="chart-container">
                    <canvas id="timelineChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Interactive Timeline Section -->
        <section id="timeline-explorer" class="bg-white rounded-xl card-shadow overflow-hidden border border-slate-100">
            <div class="p-6 bg-slate-50 border-b border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-slate-800 mb-1">ì—°ë„ë³„ ìƒì„¸ ê¸°ë¡ íƒí—˜</h2>
                    <p class="text-slate-600 text-sm">ì™¼ìª½ íƒ€ì„ë¼ì¸ì„ ë”°ë¼ê°€ë©° ì—­ì‚¬ì˜ íë¦„ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                </div>
                <!-- Era Navigation Buttons -->
                <div class="flex flex-wrap justify-center gap-2" id="era-nav">
                    <!-- Buttons injected by JS -->
                </div>
            </div>

            <!-- Content Display Area -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-0 lg:divide-x divide-slate-100 min-h-[600px]">
                
                <!-- Vertical Timeline List -->
                <div class="col-span-1 bg-slate-50 relative overflow-y-auto max-h-[700px] custom-scroll p-4">
                    <!-- Vertical Line Background -->
                    <div class="timeline-line"></div>
                    
                    <div id="event-list" class="space-y-0 relative">
                        <!-- Event items injected by JS -->
                    </div>
                </div>

                <!-- Detail View -->
                <div class="col-span-1 lg:col-span-2 p-6 md:p-10 bg-white flex flex-col justify-start items-start overflow-y-auto max-h-[700px] custom-scroll" id="detail-view">
                    <!-- Dynamic Content injected by JS -->
                </div>
            </div>
        </section>

        <!-- Search / Filter Section -->
        <section class="bg-slate-800 rounded-xl p-8 text-white">
            <div class="flex flex-col md:flex-row justify-between items-end mb-6 border-b border-slate-600 pb-4">
                <div>
                    <h2 class="text-2xl font-bold mb-2">ì „ì²´ ê¸°ë¡ ê²€ìƒ‰</h2>
                    <p class="text-slate-400 text-sm">í‚¤ì›Œë“œë¡œ ì—­ì‚¬ë¥¼ ê²€ìƒ‰í•˜ê±°ë‚˜ ì¹´í…Œê³ ë¦¬ë³„ë¡œ í•„í„°ë§í•´ë³´ì„¸ìš”.</p>
                </div>
                <div class="mt-4 md:mt-0 flex gap-2 w-full md:w-auto">
                    <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ (ì˜ˆ: ì•ˆìš©ë³µ, ì¹™ë ¹)" class="bg-slate-700 border-none text-white px-4 py-2 rounded focus:ring-2 focus:ring-blue-500 outline-none placeholder-slate-500 w-full md:w-64">
                </div>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="search-results">
                <!-- Search results injected here -->
            </div>
        </section>

    </main>

    <footer class="bg-slate-900 text-slate-500 py-8 mt-12">
        <div class="container mx-auto px-4 text-center text-sm">
            <p>&copy; 2024 Dokdo History Interactive. ëª¨ë“  ë°ì´í„°ëŠ” ì œê³µëœ ì—­ì‚¬ ì—°ë„í‘œì— ê¸°ë°˜í•©ë‹ˆë‹¤.</p>
        </div>
    </footer>

    <script>
        // --- DATA STORAGE ---
        // Added 'img' property with Wikimedia Commons URLs for key items
        const historicalData = [
            { 
                year: "460~250ë§Œ ë…„ ì „", 
                event: "ë…ë„ì˜ íƒ„ìƒ", 
                detail: "í™”ì‚° í™œë™ìœ¼ë¡œ ì¸í•´ ìš¸ë¦‰ë„(250ë§Œ ë…„ ì „), ì œì£¼ë„(120ë§Œ ë…„ ì „)ë³´ë‹¤ ë¨¼ì € ìƒì„±ëœ í™”ì‚°ì„¬ì„.", 
                era: "ancient", 
                type: "nature",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Dokdo_080628.jpg/640px-Dokdo_080628.jpg",
                imgCaption: "ëŒ€í•œë¯¼êµ­ ë™í•´ì˜ ë…ë„ ì „ê²½ (ì¶œì²˜: Wikimedia Commons)"
            },
            { 
                year: "1454ë…„", 
                event: "ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€", 
                detail: "ê°•ì›ë„ ìš¸ì§„í˜„ì¡°ì— ìš°ì‚°(ë…ë„)ê³¼ ë¬´ë¦‰(ìš¸ë¦‰ë„) ë‘ ì„¬ì´ ë‚ ì”¨ê°€ ë§‘ìœ¼ë©´ ì„œë¡œ ë°”ë¼ë³¼ ìˆ˜ ìˆë‹¤ëŠ” ê¸°ë¡ì´ ë‚˜íƒ€ë‚¨.", 
                era: "joseon", 
                type: "record",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/%EC%84%B8%EC%A2%85%EC%8B%A4%EB%A1%9D_%ED%91%9C%EC%A7%80.gif/300px-%EC%84%B8%EC%A2%85%EC%8B%A4%EB%A1%9D_%ED%91%9C%EC%A7%80.gif",
                imgCaption: "ì„¸ì¢…ì¥í—ŒëŒ€ì™•ì‹¤ë¡ í‘œì§€ (ì¶œì²˜: Wikimedia Commons)"
            },
            { 
                year: "1481ë…„", 
                event: "íŒ”ë„ì´ë„", 
                detail: "ã€Šì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒã€‹ì— ì²¨ë¶€ëœ ì§€ë„ë¡œ, ë™í•´ìƒì— ìš¸ë¦‰ë„ì™€ ìš°ì‚°ë„(ë…ë„)ê°€ ëª…í™•íˆ ê·¸ë ¤ì ¸ ìˆìŒ.", 
                era: "joseon", 
                type: "map",
                img: "https://upload.wikimedia.org/wikipedia/commons/3/36/Ulleungdo_and_Usando.jpg",
                imgCaption: "ì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒ íŒ”ë„ì´ë„ ì¤‘ ìš°ì‚°ë„(ë…ë„)ì™€ ìš¸ë¦‰ë„ (ì¶œì²˜: Wikimedia Commons)"
            },
            { 
                year: "1531ë…„", 
                event: "ì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒ", 
                detail: "ìš°ì‚°ë„ì™€ ìš¸ë¦‰ë„ì— ê´€í•œ ì¸ë¬¸ì§€ë¦¬ì  ë‚´ìš©ì´ ê¸°ìˆ ëœ ê´€ì°¬ ì§€ë¦¬ì§€ì„.", 
                era: "joseon", 
                type: "record" 
            },
            { 
                year: "1667ë…„", 
                event: "ì€ì£¼ì‹œì²­í•©ê¸°", 
                detail: "ì¼ë³¸ ê´€ë¦¬ì˜ ë³´ê³ ì„œë¡œ, ì¼ë³¸ì˜ ì„œìª½ ê²½ê³„ë¥¼ ì˜¤í‚¤ì„¬ìœ¼ë¡œ í•œì •í•˜ì—¬ ë…ë„ì™€ ìš¸ë¦‰ë„ê°€ ì¡°ì„  ë•…ì„ì„ ì‹œì‚¬í•¨.", 
                era: "joseon", 
                type: "japan_record" 
            },
            { 
                year: "1693ë…„", 
                event: "1ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", 
                detail: "ì•ˆìš©ë³µ ì¼í–‰ì´ ìš¸ë¦‰ë„ì—ì„œ ì–´ë¡œ ì‘ì—… ì¤‘ ì¼ë³¸ìœ¼ë¡œ ë‚©ì¹˜ë˜ì—ˆìœ¼ë‚˜, ë…ë„ê°€ ì¡°ì„  ì˜í† ì„ì„ ì£¼ì¥í•¨.", 
                era: "conflict", 
                type: "diplomacy" 
            },
            { 
                year: "1695ë…„", 
                event: "ë—í† ë¦¬ë²ˆ ë‹µë³€ì„œ", 
                detail: "ì—ë„ ë§‰ë¶€ì˜ ì§ˆì˜ì— ë—í† ë¦¬ë²ˆì´ ìš¸ë¦‰ë„ì™€ ë…ë„ê°€ ìêµ­ ì†Œì†ì´ ì•„ë‹˜ì„ ê³µì‹ ë‹µë³€í•¨.", 
                era: "conflict", 
                type: "japan_record" 
            },
            { 
                year: "1696ë…„ 1ì›”", 
                event: "ìš¸ë¦‰ë„ ë„í•´ ê¸ˆì§€ë ¹", 
                detail: "ì¼ë³¸ ë§‰ë¶€ê°€ ìš¸ë¦‰ë„ì™€ ë…ë„ê°€ ì¡°ì„  ë•…ì„ì„ ì¸ì •í•˜ê³  ì¼ë³¸ì¸ì˜ ì¶œì…ì„ ê¸ˆì§€í•¨.", 
                era: "conflict", 
                type: "diplomacy" 
            },
            { 
                year: "1696ë…„", 
                event: "2ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", 
                detail: "ì•ˆìš©ë³µì´ ë‹¤ì‹œ ì¼ë³¸ìœ¼ë¡œ ê±´ë„ˆê°€ ë…ë„ê°€ ì¡°ì„  ì˜í† ì„ì„ ê°•ë ¥íˆ ì£¼ì¥í•¨.", 
                era: "conflict", 
                type: "diplomacy" 
            },
            { 
                year: "1779ë…„", 
                event: "ê°œì • ì¼ë³¸ì—¬ì§€ë¡œì •ì „ë„", 
                detail: "ì¼ë³¸ì˜ ë‚˜ê°€ì¿ ë³´ ì„¸í‚¤ìŠ¤ì´ê°€ ì œì‘í•œ ì§€ë„ë¡œ, ë…ë„ë¥¼ ì¼ë³¸ ì˜ì—­ ë°–ìœ¼ë¡œ í‘œì‹œí•¨.", 
                era: "joseon_late", 
                type: "map" 
            },
            { 
                year: "1785ë…„", 
                event: "ì‚¼êµ­ì ‘ì–‘ì§€ë„", 
                detail: "ì¼ë³¸ ì‹¤í•™ì í•˜ì•¼ì‹œ ì‹œí—¤ì´ê°€ ì œì‘í•˜ì˜€ìœ¼ë©°, ë…ë„ë¥¼ ì¡°ì„ ê³¼ ê°™ì€ í™©ìƒ‰ìœ¼ë¡œ ì¹ í•˜ê³  'ì¡°ì„ ì˜ ê²ƒ'ì´ë¼ ëª…ê¸°í•¨.", 
                era: "joseon_late", 
                type: "map" 
            },
            { 
                year: "1861ë…„", 
                event: "ëŒ€ë™ì—¬ì§€ë„", 
                detail: "ê¹€ì •í˜¸ê°€ ì œì‘í•œ ëŒ€ë™ì—¬ì§€ë„ ë“± ì¡°ì„  í›„ê¸° ì§€ë„ë“¤ì€ ë…ë„ì˜ ìœ„ì¹˜ë¥¼ ëª…í™•íˆ í•˜ê³  ìˆìŠµë‹ˆë‹¤.", 
                era: "joseon_late", 
                type: "map",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Daedong_yeojido_color.jpg/640px-Daedong_yeojido_color.jpg",
                imgCaption: "ëŒ€ë™ì—¬ì§€ë„ (ì¶œì²˜: Wikimedia Commons)"
            },
            { 
                year: "1877ë…„", 
                event: "íƒœì •ê´€ ì§€ë ¹", 
                detail: "ì¼ë³¸ ìµœê³  í–‰ì •ê¸°ê´€ì´ ìš¸ë¦‰ë„ì™€ ë…ë„ëŠ” ì¼ë³¸ê³¼ ê´€ê³„ê°€ ì—†ìŒì„ ê³µì‹ì ìœ¼ë¡œ í•˜ë‹¬í•œ ë¬¸ì„œì„.", 
                era: "modern_early", 
                type: "japan_record" 
            },
            { 
                year: "1900ë…„ 10ì›” 25ì¼", 
                event: "ëŒ€í•œì œêµ­ ì¹™ë ¹ ì œ41í˜¸", 
                detail: "ë…ë„ë¥¼ ìš¸ë„êµ°(ìš¸ë¦‰ë„) ê´€í•  êµ¬ì—­ìœ¼ë¡œ ëª…ì‹œí•˜ì—¬ ëŒ€í•œì œêµ­ì˜ ì˜í† ì„ì„ ëŒ€ë‚´ì™¸ì— ê³µí¬í•¨.", 
                era: "modern_early", 
                type: "decree" 
            },
            { 
                year: "1905ë…„", 
                event: "ì‹œë§ˆë„¤í˜„ ê³ ì‹œ ì œ40í˜¸", 
                detail: "ì¼ë³¸ì´ ëŸ¬ì¼ì „ìŸ ì¤‘ ë…ë„ë¥¼ 'ë‹¤ì¼€ì‹œë§ˆ'ë¡œ ëª…ëª…í•˜ê³  ìêµ­ ì˜í† ë¡œ ë¶ˆë²• í¸ì…í•˜ë ¤ ì‹œë„í•¨.", 
                era: "modern_early", 
                type: "aggression" 
            },
            { 
                year: "1906ë…„", 
                event: "ì‹¬í¥íƒ ë³´ê³  ë° ì§€ë ¹ ì œ3í˜¸", 
                detail: "ìš¸ë¦‰êµ°ìˆ˜ ì‹¬í¥íƒì˜ ë³´ê³ ë¥¼ ë°›ì€ ëŒ€í•œì œêµ­ ì˜ì •ë¶€ê°€ ì¼ë³¸ì˜ ë…ë„ ì˜ì§€ ì£¼ì¥ì„ ê·¼ê±° ì—†ëŠ” ê²ƒìœ¼ë¡œ ê·œì •í•¨.", 
                era: "modern_early", 
                type: "decree" 
            },
            { 
                year: "1946ë…„ 1ì›” 29ì¼", 
                event: "SCAPIN ì œ677í˜¸", 
                detail: "ì—°í•©êµ°ìµœê³ ì‚¬ë ¹ê´€ ì§€ë ¹ìœ¼ë¡œ, ë…ë„ë¥¼ ì¼ë³¸ì˜ í†µì¹˜ ë²”ìœ„ì—ì„œ ì œì™¸í•˜ì—¬ í•œêµ­ ì˜í† ë¡œ ê·œì •í•¨.", 
                era: "modern_postwar", 
                type: "international" 
            },
            { 
                year: "1951ë…„ 1ì›” 18ì¼", 
                event: "í‰í™”ì„ (ì´ìŠ¹ë§Œ ë¼ì¸) ì„ í¬", 
                detail: "ì¸ì ‘ í•´ì–‘ì˜ ì£¼ê¶Œì— ëŒ€í•œ ì„ ì–¸ì„ í†µí•´ ë…ë„ë¥¼ í¬í•¨í•œ í•´ì—­ì´ ëŒ€í•œë¯¼êµ­ ê´€í• ì„ì„ ëª…í™•íˆ í•¨.", 
                era: "modern_postwar", 
                type: "decree" 
            },
            { 
                year: "1950ë…„ëŒ€ ì´ˆ", 
                event: "ë…ë„ì˜ìš©ìˆ˜ë¹„ëŒ€ í™œë™", 
                detail: "í™ìˆœì¹  ë“± ë¯¼ê°„ì¸ë“¤ì´ ìë°œì ìœ¼ë¡œ ì¡°ì§í•˜ì—¬ ì¼ë³¸ì˜ ë¶ˆë²• ì¹¨íˆ¬ë¡œë¶€í„° ë…ë„ë¥¼ ìˆ˜í˜¸í•¨.", 
                era: "modern_postwar", 
                type: "defense" 
            },
            { 
                year: "1953ë…„ 9ì›”", 
                event: "ë…ë„ê²½ë¹„ëŒ€ ìƒì‹œ ì£¼ë‘”", 
                detail: "ìš¸ë¦‰ê²½ì°°ì„œ 'ë…ë„ìˆœë¼ë°˜'ì„ ëª¨ì²´ë¡œ ë…ë„ê²½ë¹„ëŒ€ê°€ ì¡°ì§ë˜ì–´ ìƒì‹œ ì£¼ë‘”ì„ ì‹œì‘í•¨.", 
                era: "modern_postwar", 
                type: "defense" 
            },
            { 
                year: "1981ë…„", 
                event: "ìµœì´ˆ ì£¼ë¯¼ë“±ë¡ ì´ì „", 
                detail: "ìµœì¢…ë• ì”¨ê°€ ì£¼ë¯¼ë“±ë¡ì„ ë…ë„ë¡œ ì´ì „í•˜ì—¬ ë…ë„ì˜ ì²« ì£¼ë¯¼ì´ ë¨.", 
                era: "contemporary", 
                type: "admin" 
            },
            { 
                year: "1998ë…„ 9ì›”", 
                event: "ì‹ í•œì¼ ì–´ì—…í˜‘ì • ì²´ê²°", 
                detail: "ë°°íƒ€ì ê²½ì œìˆ˜ì—­(EEZ) ì¡°í•­ì— ë”°ë¼ ë…ë„ ì£¼ë³€ì„ í¬í•¨í•œ ì¤‘ê°„ìˆ˜ì—­ì„ ì„¤ì •í•¨.", 
                era: "contemporary", 
                type: "diplomacy" 
            },
            { 
                year: "2005ë…„ 3ì›” 16ì¼", 
                event: "ë‹¤ì¼€ì‹œë§ˆì˜ ë‚  ì¡°ë¡€", 
                detail: "ì¼ë³¸ ì‹œë§ˆë„¤í˜„ ì˜íšŒê°€ 2ì›” 22ì¼ì„ 'ë‹¤ì¼€ì‹œë§ˆì˜ ë‚ 'ë¡œ ì •í•˜ëŠ” ì¡°ë¡€ë¥¼ ê²°ì •í•˜ì—¬ ê°ˆë“±ì„ ìœ ë°œí•¨.", 
                era: "contemporary", 
                type: "aggression" 
            },
            { 
                year: "2008ë…„", 
                event: "ë…ë„ì—°êµ¬ì†Œ ì„¤ë¦½", 
                detail: "ë…ë„ ê´€ë ¨ ì¡°ì‚¬, ì—°êµ¬ ë° ì •ì±… ê°œë°œì„ ìœ„í•œ ì •ë¶€ ì—°êµ¬ê¸°ê´€ì´ ì¶œë²”í•¨.", 
                era: "contemporary", 
                type: "admin" 
            },
            { 
                year: "2011ë…„~í˜„ì¬", 
                event: "ì¼ë³¸ êµê³¼ì„œ ì™œê³¡ ì‹¬í™”", 
                detail: "ì¼ë³¸ ì¤‘í•™êµ êµê³¼ì„œ ë“±ì— ë…ë„ê°€ ì¼ë³¸ ê³ ìœ  ì˜í† ì´ë©° í•œêµ­ì´ ë¶ˆë²• ì ê±°í•˜ê³  ìˆë‹¤ëŠ” ê¸°ìˆ ì´ ê¸‰ì¦í•¨.", 
                era: "contemporary", 
                type: "aggression" 
            }
        ];

        const eras = [
            { id: "all", label: "ì „ì²´ ë³´ê¸°", range: "ì „ ì‹œëŒ€" },
            { id: "ancient", label: "íƒœì´ˆì˜ ë…ë„", range: "460ë§Œë…„ ì „" },
            { id: "joseon", label: "ì¡°ì„  ì´ˆê¸°/ì¤‘ê¸°", range: "1400~1600ë…„ëŒ€" },
            { id: "conflict", label: "ì•ˆìš©ë³µê³¼ ë¶„ìŸ", range: "1690ë…„ëŒ€" },
            { id: "joseon_late", label: "ì¡°ì„  í›„ê¸°", range: "1700~1800ë…„ëŒ€" },
            { id: "modern_early", label: "ëŒ€í•œì œêµ­", range: "1800ë§~1900ì´ˆ" },
            { id: "modern_postwar", label: "ê´‘ë³µê³¼ ìˆ˜í˜¸", range: "1940~1950ë…„ëŒ€" },
            { id: "contemporary", label: "í˜„ì¬ì˜ ë…ë„", range: "1980~í˜„ì¬" }
        ];

        const typeLabels = {
            "nature": "ìì—°ì‚¬",
            "record": "í•œêµ­ ë¬¸í—Œ",
            "map": "ê³ ì§€ë„",
            "japan_record": "ì¼ë³¸ ë¬¸í—Œ/ì¸ì •",
            "diplomacy": "ì™¸êµ/ë‹´íŒ",
            "decree": "ì¹™ë ¹/ì„ í¬",
            "aggression": "ì¼ë³¸ì˜ ë„ë°œ",
            "international": "êµ­ì œ í˜‘ì•½",
            "defense": "ìˆ˜í˜¸ í™œë™",
            "admin": "ì‹¤íš¨ì  ì§€ë°°"
        };

        const eraDescriptions = {
            "all": "ì„ ì‚¬ì‹œëŒ€ë¶€í„° í˜„ëŒ€ì— ì´ë¥´ê¸°ê¹Œì§€ ë…ë„ ì—­ì‚¬ì˜ ì „ì²´ íë¦„ì…ë‹ˆë‹¤.",
            "ancient": "ë…ë„ëŠ” ìš¸ë¦‰ë„ì™€ ì œì£¼ë„ë³´ë‹¤ ë¨¼ì € ìƒì„±ëœ í™”ì‚°ì„¬ìœ¼ë¡œ, ë™í•´ì˜ í•´ì–‘ í™˜ê²½ì„ ê°„ì§í•œ ìì—°ìœ ì‚°ì…ë‹ˆë‹¤.",
            "joseon": "ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€ ë“± ì¡°ì„ ì˜ ê´€ì°¬ ê¸°ë¡ë“¤ì€ ìš°ì‚°êµ­(ë…ë„)ì´ ì¡°ì„ ì˜ ì˜í† ì„ì„ ëª…í™•íˆ í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
            "conflict": "ì•ˆìš©ë³µì˜ í™œì•½ìœ¼ë¡œ ì¼ë³¸ ë§‰ë¶€ëŠ” ìš¸ë¦‰ë„ì™€ ë…ë„ê°€ ì¡°ì„ ì˜ ë•…ì„ì„ ê³µì‹ì ìœ¼ë¡œ ì¸ì •í–ˆìŠµë‹ˆë‹¤.",
            "joseon_late": "18ì„¸ê¸° ì¼ë³¸ì˜ ì§€ë„ë“¤ì¡°ì°¨ ë…ë„ë¥¼ ì¡°ì„ ì˜ ì˜í† ë¡œ í‘œê¸°í•˜ê±°ë‚˜ ì¼ë³¸ ì˜ì—­ ë°–ìœ¼ë¡œ ë¶„ë¥˜í–ˆìŠµë‹ˆë‹¤.",
            "modern_early": "ëŒ€í•œì œêµ­ì€ ì¹™ë ¹ ì œ41í˜¸ë¥¼ í†µí•´ ë…ë„ ê´€í• ê¶Œì„ ë²•ì ìœ¼ë¡œ ì„ í¬í–ˆìœ¼ë‚˜, ì¼ë³¸ì€ ì´ë¥¼ ë¶ˆë²• í¸ì…í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤.",
            "modern_postwar": "2ì°¨ ëŒ€ì „ ì¢…ì „ í›„, ì—°í•©êµ­ì€ ë…ë„ë¥¼ ì¼ë³¸ì˜ í†µì¹˜ ë²”ìœ„ì—ì„œ ì œì™¸í•˜ë©° í•œêµ­ì˜ ì˜í† ë¡œ í™•ì¸í–ˆìŠµë‹ˆë‹¤.",
            "contemporary": "í˜„ì¬ ë…ë„ëŠ” ëŒ€í•œë¯¼êµ­ ê²½ì°°ì´ ìƒì£¼í•˜ë©° ì£¼ë¯¼ì´ ê±°ì£¼í•˜ëŠ”, ëŒ€í•œë¯¼êµ­ì´ ì‹¤íš¨ì ìœ¼ë¡œ ì§€ë°°í•˜ëŠ” ê³ ìœ  ì˜í† ì…ë‹ˆë‹¤."
        };

        let currentEra = "all";
        let activeEventYear = null;

        const eraNav = document.getElementById('era-nav');
        const eventList = document.getElementById('event-list');
        const detailView = document.getElementById('detail-view');
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('search-results');

        function init() {
            renderCharts();
            renderEraNav();
            renderSearchResults(""); 
            selectEra("all");
        }

        // --- CHARTS ---
        function renderCharts() {
            // Chart 1: Category Distribution
            const typeCounts = {};
            historicalData.forEach(d => {
                typeCounts[d.type] = (typeCounts[d.type] || 0) + 1;
            });

            const ctx1 = document.getElementById('categoryChart').getContext('2d');
            new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(typeCounts).map(k => typeLabels[k]),
                    datasets: [{
                        data: Object.values(typeCounts),
                        backgroundColor: [
                            '#94a3b8', '#3b82f6', '#60a5fa', '#f87171', '#fb923c', 
                            '#1e40af', '#dc2626', '#a855f7', '#16a34a', '#0d9488'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, font: { size: 10 } } }
                    }
                }
            });

            // Chart 2: Timeline Density
            const eraCounts = {};
            eras.filter(e => e.id !== 'all').forEach(e => eraCounts[e.id] = 0);
            historicalData.forEach(d => {
                if(eraCounts[d.era] !== undefined) eraCounts[d.era]++;
            });

            const ctx2 = document.getElementById('timelineChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: eras.filter(e => e.id !== 'all').map(e => e.label.replace(" ", "\n")),
                    datasets: [{
                        label: 'ì‚¬ê±´ ìˆ˜',
                        data: Object.values(eraCounts),
                        backgroundColor: '#1e3a8a',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1 } },
                        x: { ticks: { font: { size: 10 } } }
                    }
                }
            });
        }

        // --- NAVIGATION & TIMELINE ---
        function renderEraNav() {
            eraNav.innerHTML = eras.map(era => `
                <button 
                    onclick="selectEra('${era.id}')"
                    class="px-3 py-1 rounded-full border border-slate-200 text-xs md:text-sm font-medium transition-colors hover:bg-slate-50 ${era.id === currentEra ? 'bg-blue-900 text-white border-blue-900' : 'text-slate-600 bg-white'}"
                    id="btn-${era.id}"
                >
                    ${era.label}
                </button>
            `).join('');
        }

        function selectEra(eraId) {
            currentEra = eraId;
            
            eras.forEach(e => {
                const btn = document.getElementById(`btn-${e.id}`);
                if (e.id === eraId) {
                    btn.className = "px-3 py-1 rounded-full border border-blue-900 bg-blue-900 text-white text-xs md:text-sm font-medium transition-colors shadow-md";
                } else {
                    btn.className = "px-3 py-1 rounded-full border border-slate-200 text-slate-600 bg-white text-xs md:text-sm font-medium transition-colors hover:bg-slate-50";
                }
            });

            const eraEvents = eraId === "all" ? historicalData : historicalData.filter(d => d.era === eraId);
            renderEventList(eraEvents);
            
            if (eraEvents.length > 0) {
                renderDetailView(eraEvents[0]);
            } else {
                detailView.innerHTML = '<div class="w-full h-full flex items-center justify-center text-slate-400">ì´ ì‹œëŒ€ì˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        function renderEventList(events) {
            eventList.innerHTML = events.map((ev, idx) => {
                const isActive = idx === 0 ? 'active' : ''; 
                if (idx === 0) activeEventYear = ev.year; 

                return `
                <div 
                    onclick='handleEventClick(this, ${JSON.stringify(ev).replace(/'/g, "&#39;")})'
                    class="timeline-item flex group cursor-pointer py-4 pl-12 pr-2 rounded-r-lg hover:bg-slate-100 transition-colors ${isActive}"
                    id="event-item-${ev.year.replace(/\s/g, '')}"
                >
                    <div class="timeline-dot"></div>
                    <div class="flex-1">
                        <div class="text-xs font-bold text-blue-800 mb-1">${ev.year}</div>
                        <h4 class="text-sm font-medium text-slate-700 group-hover:text-blue-900 leading-snug">${ev.event}</h4>
                        <span class="text-[10px] text-slate-400 border border-slate-200 px-1 rounded mt-1 inline-block">${typeLabels[ev.type]}</span>
                    </div>
                </div>
            `}).join('');
        }

        function handleEventClick(element, eventData) {
            document.querySelectorAll('.timeline-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            renderDetailView(eventData);
        }

        function renderDetailView(event) {
            const eraInfo = eras.find(e => e.id === event.era);
            
            let icon = "ğŸ“„";
            if(event.type === 'map') icon = "ğŸ—ºï¸";
            if(event.type === 'conflict' || event.type === 'defense') icon = "ğŸ›¡ï¸";
            if(event.type === 'nature') icon = "ğŸŒ‹";
            if(event.type === 'aggression') icon = "âš ï¸";
            if(event.type === 'japan_record') icon = "ğŸ‡¯ğŸ‡µ";
            if(event.type === 'international') icon = "âš–ï¸";

            // Check if image exists
            let imageHtml = '';
            if (event.img) {
                imageHtml = `
                    <div class="mb-6 rounded-lg overflow-hidden border border-slate-200 shadow-sm group relative">
                        <img src="${event.img}" alt="${event.event}" class="w-full h-auto object-cover max-h-[300px] hover:scale-105 transition-transform duration-500" onerror="this.style.display='none'">
                        ${event.imgCaption ? `<div class="bg-black/70 text-white text-xs p-2 absolute bottom-0 w-full opacity-0 group-hover:opacity-100 transition-opacity">${event.imgCaption}</div>` : ''}
                    </div>
                `;
            }

            detailView.innerHTML = `
                <div class="w-full animate-fade-in opacity-0" style="animation: fadeIn 0.5s forwards;">
                    <div class="flex items-center space-x-2 text-sm text-slate-500 mb-6">
                        <span class="font-bold text-blue-900 uppercase tracking-widest bg-blue-50 px-2 py-1 rounded">${eraInfo.label}</span>
                        <span class="text-slate-300">|</span>
                        <span>${eraInfo.range}</span>
                    </div>
                    
                    <h2 class="text-3xl md:text-4xl font-serif font-bold text-slate-900 mb-4 leading-tight">
                        ${event.event}
                    </h2>
                    
                    <div class="inline-flex items-center bg-slate-800 text-white px-4 py-2 rounded-lg text-lg font-bold mb-6 shadow-md">
                        <span class="mr-2">ğŸ“…</span> ${event.year}
                    </div>

                    ${imageHtml}

                    <div class="bg-gradient-to-br from-blue-50 to-white border border-blue-100 p-6 md:p-8 rounded-xl shadow-sm mb-8 relative overflow-hidden">
                        <div class="absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-blue-100 rounded-full opacity-50 blur-xl"></div>
                        <div class="flex items-start relative z-10">
                            <div class="text-4xl mr-6 p-2 bg-white rounded-lg shadow-sm">${icon}</div>
                            <div>
                                <h3 class="font-bold text-blue-900 mb-2 text-lg">ì—­ì‚¬ì  ì‚¬ì‹¤ ë° ë‚´ìš©</h3>
                                <p class="text-slate-700 leading-loose text-lg font-light">
                                    ${event.detail}
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 w-full">
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-100">
                            <h5 class="text-xs font-bold text-slate-400 uppercase mb-1">ê¸°ë¡ ìœ í˜•</h5>
                            <p class="font-medium text-slate-700 flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-blue-500"></span>
                                ${typeLabels[event.type]}
                            </p>
                        </div>
                         <div class="bg-slate-50 p-4 rounded-lg border border-slate-100">
                            <h5 class="text-xs font-bold text-slate-400 uppercase mb-1">ì‹œëŒ€ì  ë°°ê²½</h5>
                            <p class="font-medium text-slate-700 text-sm leading-snug">
                                ${eraDescriptions[event.era]}
                            </p>
                        </div>
                    </div>
                </div>
                <style>
                    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
                </style>
            `;
        }

        // --- SEARCH ---
        searchInput.addEventListener('input', (e) => {
            renderSearchResults(e.target.value);
        });

        function renderSearchResults(query) {
            const cleanQuery = query.toLowerCase().trim();
            
            let results = historicalData;
            if (cleanQuery !== "") {
                results = historicalData.filter(d => 
                    d.event.toLowerCase().includes(cleanQuery) || 
                    d.detail.toLowerCase().includes(cleanQuery) ||
                    d.year.includes(cleanQuery)
                );
            }

            const displayResults = cleanQuery === "" ? results.slice(0, 8) : results;

            searchResults.innerHTML = displayResults.map(d => `
                <div class="bg-slate-700 p-4 rounded hover:bg-slate-600 transition-colors cursor-pointer group" onclick="jumpToEvent('${d.year}', '${d.event}')">
                    <div class="flex justify-between items-start mb-1">
                        <div class="text-xs text-blue-300 font-bold">${d.year}</div>
                        <div class="text-[10px] text-slate-500 border border-slate-600 px-1 rounded">${typeLabels[d.type]}</div>
                    </div>
                    <div class="font-medium text-white truncate group-hover:text-blue-200 transition-colors">${d.event}</div>
                    <div class="text-xs text-slate-400 mt-2 truncate">${d.detail}</div>
                </div>
            `).join('');
            
            if(results.length === 0) {
                searchResults.innerHTML = `<div class="col-span-full text-center text-slate-500 py-4">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
            }
        }

        function jumpToEvent(year, eventName) {
            const target = historicalData.find(d => d.year === year && d.event === eventName);
            if(target) {
                document.getElementById('timeline-explorer').scrollIntoView({ behavior: 'smooth' });
                selectEra(target.era);
                
                setTimeout(() => {
                    const itemID = `event-item-${target.year.replace(/\s/g, '')}`;
                    const listEl = document.getElementById(itemID);
                    if(listEl) {
                        listEl.scrollIntoView({ block: 'center', behavior: 'smooth' });
                        listEl.click();
                    }
                }, 100);
            }
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
